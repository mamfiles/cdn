document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelectorAll(".view-btn"),e=document.querySelector(".overlay"),n=document.querySelectorAll(".popup"),o=document.querySelectorAll(".close-btn");let i,a,s,d,c=!1,l=!1,r=[],u=!1;function m(t){const e=document.getElementById(t);e&&w(e)}function p(t,e){if(t.preventDefault(),!l){T(`${window.location.origin}${window.location.pathname}?view=${e}`),v(e)}}function v(t){alert(`Link copied to clipboard: ${t}`),l=!0,setTimeout((()=>{l=!1,r.length>0&&r.shift()()}),1e3)}function y(t){c&&!u&&1===t.touches.length&&(a=t.touches[0].clientY,s=parseInt(i.style.top)||i.getBoundingClientRect().top)}function f(t){if(!c||u||1!==t.touches.length)return;const e=t.touches[0].clientY-a;i.style.top=`${Math.max(s+e,s)}px`}function h(t){if(!c||u)return;const e=t.changedTouches[0].clientY-a;e>.5*i.offsetHeight?(E(),b()):function(t){const e=300;i.style.transition="top 0.3s ease",i.style.top=`${s}px`,setTimeout((()=>{i.style.transition=""}),e)}()}function L(t){t.preventDefault()}function w(t){u=!0,window.innerWidth<768?(t.style.top="auto",t.style.bottom="0",t.style.transform="translate(-50%, 0)",t.classList.add("slide-in-animation"),e.classList.add("fade-in-animation")):(e.style.display="block",e.classList.add("fade-in-animation"),t.style.top="50%",t.style.bottom="auto",t.style.transform="translate(-50%, -50%)",t.classList.add("popup-appear-animation")),e.style.display="block",t.style.display="block",e.classList.add("show"),t.classList.add("show"),c=!0,document.body.style.overflow="hidden",i=t,document.addEventListener("touchmove",L,{passive:!1}),setTimeout((()=>{u=!1}),300)}function E(){u=!0,window.innerWidth<768?(i.style.top=i.getBoundingClientRect().top+"px",i.classList.add("slide-out-animation"),e.classList.add("fade-out-animation"),setTimeout((function(){e.style.display="none",i.style.display="none",i.classList.remove("slide-out-animation"),e.classList.remove("fade-out-animation"),u=!1}),300)):(e.classList.add("fade-out-animation"),i.classList.add("popup-disappear-animation"),setTimeout((function(){e.style.display="none",i.style.display="none",e.classList.remove("fade-out-animation"),i.classList.remove("popup-disappear-animation"),u=!1}),300)),c=!1,document.body.style.overflow="",document.removeEventListener("touchmove",L,{passive:!1})}function g(){const t=window.innerWidth<768;n.forEach((e=>{e.style.top=t?"auto":"50%",e.style.bottom=t?"0":"auto",e.style.transform=t?"translate(-50%, 0)":"translate(-50%, -50%)"}))}function b(){history.replaceState({},document.title,window.location.pathname)}function T(t){navigator.clipboard.writeText(t).then((()=>{console.log("Link copied to clipboard:",t)})).catch((t=>{console.error("Could not copy link:",t)}))}t.forEach((t=>{const e=t.getAttribute("data-popup");t.addEventListener("click",(()=>m(e))),t.addEventListener("keydown",(t=>{["Enter","Space"].includes(t.code)&&m(e)})),t.addEventListener("contextmenu",(t=>function(t,e){t.preventDefault(),T(`${window.location.origin}${window.location.pathname}?view=${e}`),0!==r.length||l?r.push((()=>v(e))):v(e)}(t,e))),t.addEventListener("touchstart",(t=>{d=setTimeout((()=>p(t,e)),800)})),t.addEventListener("touchend",(()=>clearTimeout(d))),t.addEventListener("mousedown",(t=>{d=setTimeout((()=>p(t,e)),800)})),t.addEventListener("mouseup",(()=>clearTimeout(d))),t.addEventListener("mouseleave",(()=>clearTimeout(d)))})),o.forEach((t=>{t.addEventListener("click",(()=>{E(),b()}))})),e.addEventListener("click",(t=>t.stopPropagation())),window.addEventListener("resize",g),window.addEventListener("click",(t=>{c&&t.target===e&&E()})),document.addEventListener("touchstart",y),e.addEventListener("touchstart",y),document.addEventListener("touchmove",f),e.addEventListener("touchmove",f),document.addEventListener("touchend",h),e.addEventListener("touchend",h),function(){const t=new URLSearchParams(window.location.search).get("view");t&&w(document.getElementById(t))}(),g()}));
